# Log rotation configuration for KuzuMemory Claude Code hooks
#
# Installation (macOS/Linux):
#   sudo cp .claude/hooks/logrotate.conf /etc/logrotate.d/kuzu-hooks
#   sudo chmod 644 /etc/logrotate.d/kuzu-hooks
#
# Or for user-specific rotation (no sudo):
#   1. Create ~/.logrotate.conf with contents of this file
#   2. Add to crontab: 0 0 * * * /usr/sbin/logrotate ~/.logrotate.conf
#
# Test rotation:
#   logrotate -f ~/.logrotate.conf  # Force rotation for testing

# Enhance hook logs
/tmp/kuzu_enhance.log {
    # Rotate daily
    daily

    # Keep 7 days of logs
    rotate 7

    # Compress old logs with gzip
    compress

    # Delay compression until next rotation
    delaycompress

    # Don't error if log file is missing
    missingok

    # Don't rotate empty files
    notifempty

    # Create new log with these permissions
    create 0644 masa staff

    # Post-rotation script (optional)
    postrotate
        # Could send notification or clean up old logs
        # echo "Rotated kuzu_enhance.log at $(date)" >> /tmp/kuzu_rotation.log
    endscript
}

# Learn hook logs
/tmp/kuzu_learn.log {
    # Rotate daily
    daily

    # Keep 7 days of logs
    rotate 7

    # Compress old logs
    compress
    delaycompress

    # Don't error if missing
    missingok
    notifempty

    # Create with permissions
    create 0644 masa staff

    postrotate
        # Optional notification
        # echo "Rotated kuzu_learn.log at $(date)" >> /tmp/kuzu_rotation.log
    endscript
}

# Alternative: Rotate by size instead of daily
# Uncomment this section and comment out the daily sections above
#
# /tmp/kuzu_*.log {
#     # Rotate when file reaches 10MB
#     size 10M
#
#     # Keep 10 rotations
#     rotate 10
#
#     compress
#     delaycompress
#     missingok
#     notifempty
#     create 0644 masa staff
# }
