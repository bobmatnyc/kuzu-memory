#!/usr/bin/env bash
# kuzu-memory-dev - Run kuzu-memory from source for development
#
# This script activates the project's virtual environment and runs
# the CLI from the local source code (not the installed package).
# This is useful for development and testing changes.
#
# Usage: ./kuzu-memory-dev [arguments]
# Examples:
#   ./kuzu-memory-dev --version
#   ./kuzu-memory-dev --help
#   ./kuzu-memory-dev memory enhance "How to build APIs?"

# Get the absolute path to the script's directory
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VENV_DIR="$SCRIPT_DIR/.venv"

# Check if venv exists
if [ ! -d "$VENV_DIR" ]; then
    echo "Error: Virtual environment not found at $VENV_DIR" >&2
    echo "Run the following to set up the development environment:" >&2
    echo "  python -m venv .venv" >&2
    echo "  pip install -e '.[dev]'" >&2
    exit 1
fi

# Activate venv
source "$VENV_DIR/bin/activate"

# Run the CLI from source
# The -m flag tells Python to run the module as a script
python -m kuzu_memory.cli.commands "$@"
